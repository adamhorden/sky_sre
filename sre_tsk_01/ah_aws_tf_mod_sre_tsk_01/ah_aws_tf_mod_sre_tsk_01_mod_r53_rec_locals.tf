# Copyright (c) 2023 - 2023 Adam Horden <adam.horden@horden.engineering>

# ----------------------------------------------------------------------------------------
# Locals:
# ----------------------------------------------------------------------------------------

locals {

  # --------------------------------------------------------------------------------------
  # Local:
  # --------------------------------------------------------------------------------------

  # local.sre_tsk_01_r53_rec_recs

  sre_tsk_01_r53_rec_recs = tolist(
    [

      {

        alias = {

          # ------------------------------------------------------------------------------
          #
          # ------------------------------------------------------------------------------

          #

          name = format(
            "%s",
            lookup(
              module.sre_tsk_01_alb,
              "lb_dns_name",
              tostring("")
            )
          )

          # ------------------------------------------------------------------------------
          #
          # ------------------------------------------------------------------------------

          #

          zone_id = format(
            "%s",
            lookup(
              module.sre_tsk_01_alb,
              "lb_zone_id",
              tostring("")
            )
          )

          # ------------------------------------------------------------------------------

        }

        # grafana.sky.services.adam.horden.in
        # influxdb.sky.services.adam.horden.in
        # node.prometheus.sky.services.adam.horden.in
        # prometheus.sky.services.adam.horden.in

        name = "*.sky.services"
        type = "A"

      },

      {

        alias = {

          # ------------------------------------------------------------------------------
          #
          # ------------------------------------------------------------------------------

          #

          name = format(
            "%s",
            lookup(
              module.sre_tsk_01_alb,
              "lb_dns_name",
              tostring("")
            )
          )

          # ------------------------------------------------------------------------------
          #
          # ------------------------------------------------------------------------------

          #

          zone_id = format(
            "%s",
            lookup(
              module.sre_tsk_01_alb,
              "lb_zone_id",
              tostring("")
            )
          )

          # ------------------------------------------------------------------------------

        }

        name = "*.sky.services"
        type = "AAAA"

      }

    ]
  )

  # --------------------------------------------------------------------------------------
  # Local:
  # --------------------------------------------------------------------------------------

  # local.sre_tsk_01_r53_rec_zne_nm

  sre_tsk_01_r53_rec_zne_nm = format(
    "%s",
    join(
      tostring("."),
      tolist(
        [

          # ------------------------------------------------------------------------------
          # For:
          # ------------------------------------------------------------------------------

          for
          aws_r53_zne_nm_val
          in
          lookup(
            local.ah_aws_tf_mod.r53_rec,
            "zone_name",
            tolist([])
          ) :
          aws_r53_zne_nm_val

          # ------------------------------------------------------------------------------

        ]
      )
    )
  )

}
